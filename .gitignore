{
    "code": 200,
    "data": {
        "customerName": "FRANCO JACK",
        "customerAddress": "JACK FRANCO 425 EAST 58TH STREET APT # 48 B NEW YORK NY 10022",
        "customerAccountOfficer": "036 Sigalit Levy-Shabi        BR 4",
        "cif": "F016583",
        "fees": [
            {
                "feeType": "Customer Fees",
                "feeGroups": [
                    {
                        "name": "Standard Fees",
                        "code": 1,
                        "fields": [
                            {
                                "code": 1,
                                "name": "Account Maintenance Fee",
                                "defaultValue": "25",
                                "tooltip": "Monthly - Charged Quarterly",
                                "isException": false,
                                "exceptionOptions": [],
                                "labelValue": "$25.00"
                            },
                            {
                                "code": 2,
                                "name": "Hold Mail Fee",
                                "defaultValue": "",
                                "tooltip": "Annual - Charged Annual",
                                "isException": false,
                                "exceptionOptions": [],
                                "labelValue": "$0.00"
                            }
                        ],
                        "kycMailingStatus": "Standard",
                        "cif": "F016583",
                        "accountNumber": 7115342
                    },
                    {
                        "name": "Client Current Fees",
                        "code": 2,
                        "fields": [
                            {
                                "code": 1,
                                "name": "Account Maintenance Fee",
                                "defaultValue": "",
                                "tooltip": "",
                                "isException": false,
                                "exceptionOptions": []
                            },
                            {
                                "code": 2,
                                "name": "Hold Mail Fee",
                                "defaultValue": "",
                                "tooltip": "",
                                "isException": false,
                                "exceptionOptions": []
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": 7115342
                    },
                    {
                        "name": "Exceptions",
                        "code": 3,
                        "fields": [
                            {
                                "code": 1,
                                "name": "Account Maintenance Fee",
                                "defaultValue": "0",
                                "tooltip": "",
                                "isException": true,
                                "exceptionOptions": [],
                                "labelValue": ""
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": 7115342
                    }
                ]
            },
            {
                "feeType": "Bank Account Fees",
                "feeGroups": [
                    {
                        "name": "Standard Fees",
                        "code": 1,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "25",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43933"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43934"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43935"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43936"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43937"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43938"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "25",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43939"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4393a"
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": "7113617",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a920d192d95dd614c43932"
                    },
                    {
                        "name": "Client Current Fees",
                        "code": 2,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43957"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43958"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43959"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4395a"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4395b"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4395c"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4395d"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4395e"
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": "7113617",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a920d192d95dd614c43956"
                    },
                    {
                        "name": "Exceptions",
                        "code": 3,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": true,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "0",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4396f",
                                "labelValue": ""
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": true,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "0",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43970",
                                "labelValue": ""
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": "7113617",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a920d192d95dd614c4396e"
                    },
                    {
                        "name": "Standard Fees",
                        "code": 1,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "25",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43921"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43922"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43923"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43924"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43925"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43926"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "25",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43927"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43928"
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": "7115342",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a920d092d95dd614c43920"
                    },
                    {
                        "name": "Client Current Fees",
                        "code": 2,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43945"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43946"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43947"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43948"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43949"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4394a"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4394b"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4394c"
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": "7115342",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a920d192d95dd614c43944"
                    },
                    {
                        "name": "Exceptions",
                        "code": 3,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": true,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "0",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43969",
                                "labelValue": ""
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": true,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "0",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4396a",
                                "labelValue": ""
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": "7115342",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a920d192d95dd614c43968"
                    },
                    {
                        "name": "Standard Fees",
                        "code": 1,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "25",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4393c"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4393d"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4393e"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4393f"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43940"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43941"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "25",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43942"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43943"
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": "7115431",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a920d192d95dd614c4393b"
                    },
                    {
                        "name": "Client Current Fees",
                        "code": 2,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43960"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43961"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43962"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43963"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43964"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43965"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43966"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43967"
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": "7115431",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a920d192d95dd614c4395f"
                    },
                    {
                        "name": "Exceptions",
                        "code": 3,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": true,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "0",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43972",
                                "labelValue": ""
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": true,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "0",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43973",
                                "labelValue": ""
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": "7115431",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a920d192d95dd614c43971"
                    },
                    {
                        "name": "Standard Fees",
                        "code": 1,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "25",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4392a"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4392b"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4392c"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4392d"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4392e"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4392f"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "25",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43930"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43931"
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": "7115822",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a920d192d95dd614c43929"
                    },
                    {
                        "name": "Client Current Fees",
                        "code": 2,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4394e"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4394f"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43950"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43951"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43952"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43953"
                            },
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43954"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c43955"
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": "7115822",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a920d192d95dd614c4394d"
                    },
                    {
                        "name": "Exceptions",
                        "code": 3,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": true,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "0",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4396c",
                                "labelValue": ""
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": true,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "0",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a920d192d95dd614c4396d",
                                "labelValue": ""
                            }
                        ],
                        "cif": "F016583",
                        "accountNumber": "7115822",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a920d192d95dd614c4396b"
                    }
                ]
            }
        ],
        "feesActives": [],
        "documentUrl": "https://minio-ui.dev.k8s.safra.int/api/v1/buckets/jarvis-public/objects/download?preview=true&prefix=U2NoZWR1bGVPZkZlZXMucGRm",
        "currentFees": [
            {
                "feeDescription": "Hold Mail Fee (per annum) -  $0.00",
                "feeCode": " Personal Checking -D 7113617"
            },
            {
                "feeDescription": "USD/FX Outgoing Wire Fee $75.00",
                "feeCode": " Personal Checking -D 7113617"
            },
            {
                "feeDescription": "USD/FX Outgoing Wire Fee $75.00",
                "feeCode": " Personal Checking -D 7115342"
            },
            {
                "feeDescription": "USD/FX Outgoing Wire Fee $75.00",
                "feeCode": " Personal Promise   D 7115431"
            },
            {
                "feeDescription": "Account Maintenance Fee $1,200 (S/A $600) -  $0.00",
                "feeCode": " Personal Savings 7115822"
            },
            {
                "feeDescription": "USD/FX Outgoing Wire Fee $75.00",
                "feeCode": " Personal Savings 7115822"
            }
        ]
    }
}


import { Fee } from '#src/models/entities/Fees.js';
import Result from '#features/shared/result.js';
import CustomerFees from '#src/models/CustomerFees.js';
import BankAccountFee from '#src/models/BankAccountFee.js';
import InvestimentAccountFee from '#src/models/InvestimentAccountFee.js';
import { FeeCase } from '#src/models/entities/FeeCase.js';
// import { Field } from '#src/models/entities/Fields.js';
import {
  connectToFeeMgmtDb,
  executeStoreProcedure,
} from '#core/data/mssql/index.js';

const deParaFeeCodes = {
  JH001: 1,
  JH002: 2,
  JH006: 4,
  JH007: 8,
  BPS002: 6,
  BPS003: 5,
  BPS004: 7,
  BPS005: 7,
  JH010: 3,
};

export default class FeeGetByCifUseCase {
  async execute({ customerAccount }) {
    const result = { fees: [] };

    const { groupedFees, accounts } = await this.#getFeesStructuredFromSQL(
      customerAccount
    );

    const customer = new CustomerFees(groupedFees, accounts);
    if (customer.fee) result.fees.push(customer.fee);

    const bank = new BankAccountFee(groupedFees, accounts);
    if (bank.fee) result.fees.push(bank.fee);

 
let investmentGroup = groupedFees['Investment Account Fees'];
if (investmentGroup) {
  const equityFields = accounts.filter((account) => account.feeType === 3); 
  equityFields.forEach((field) => {
    let investmentGroupFields = investmentGroup.feeGroups.find((group) => group.name === 'Standard Fees');
    if (!investmentGroupFields) {
      investmentGroupFields = {
        name: 'Standard Fees',
        code: 1,
        fields: [],
      };
      investmentGroup.feeGroups.push(investmentGroupFields);
    }

    investmentGroupFields.fields.push({
      code: field.code,
      name: field.name || 'Equity and Options Commission',
      defaultValue: field.defaultValue || '',
      tooltip: field.tooltip || '',
      isException: field.isException || false,
    });
  });

  result.fees.push(investmentGroup);
}


    // Buscar casos ativos de Fees
    const feesActives = await FeeCase.find({
      cif: customerAccount[0].cifno,
      status: {
        $nin: ['DONE', 'REJECTED'],
      },
      caseNumber: {
        $exists: true,
      },
    });

    result.feesActives = feesActives?.map((x) => ({
      caseNumber: x.caseNumber,
      id: x.id,
    }));

    result.documentUrl = this.#getDocumentUrl(feePackageId);

   

    return Result.ok(result);
  }

  async #getFeesStructuredFromSQL(customerAccount) {
    const feesData = await this.#getFeesFromSQL(customerAccount[0].cifno);

    const feePackageId = feesData[0]?.['Default Fee Package Id'];
    if (!feePackageId) {
      throw new Error('Default Fee Package Id not found in feesData');
    }

    const accounts = feesData.map((fee) => ({
      cifno: fee.CIFNO,
      ddaNumber: fee.ACCTNO,
      branchCity: fee['Branch City'],
      branchState: fee['Branch State'],
      branchType: fee['Branch Type'],
      defaultPackageType: fee['Default Package Type'],
      feeType: this.#mapFeeType(fee.FeeType),
      feeGroup: 1, 
      kycMailingStatus: fee.StandardException === 'Standard' ? 'Standard' : 'Hold Mail',
    }));

    const groupedFees = {};

    for (const fee of feesData) {
      const { FeeType, FeeDescription, FeeCode, FeeAmount, Frequency, DefaultFeeAmount, DefaultFrequency } = fee;

      const mappedCode = deParaFeeCodes[FeeCode] || FeeCode;

      if (!groupedFees[FeeType]) {
        groupedFees[FeeType] = {
          feeType: FeeType,
          feeGroups: [],
        };
      }

      let standardGroup = groupedFees[FeeType].feeGroups.find((group) => group.name === 'Standard Fees');
      if (!standardGroup) {
        standardGroup = {
          name: 'Standard Fees',
          code: 1,
          fields: [],
        };
        groupedFees[FeeType].feeGroups.push(standardGroup);
      }

      standardGroup.fields.push({
        code: mappedCode,
        name: FeeDescription,
        defaultValue: FeeAmount ? FeeAmount.toString() : '',
        tooltip: Frequency ? Frequency : '',
        isException: false,
      });

      let clientCurrentGroup = groupedFees[FeeType].feeGroups.find((group) => group.name === 'Client Current Fees');
      if (!clientCurrentGroup) {
        clientCurrentGroup = {
          name: 'Client Current Fees',
          code: 2,
          fields: [],
        };
        groupedFees[FeeType].feeGroups.push(clientCurrentGroup);
      }

      clientCurrentGroup.fields.push({
        code: mappedCode,
        name: FeeDescription,
        defaultValue: DefaultFeeAmount ? DefaultFeeAmount.toString() : '',
        tooltip: DefaultFrequency ? DefaultFrequency : '',
        isException: false,
      });
    }

    const exceptions = await this.#getExceptionFeesFromSQL(feePackageId);
    console.log('Exceptions from SQL:', exceptions);

    for (const exception of exceptions) {
      const { code, name, defaultValue, tooltip, isException } = exception;

      const feeType = Object.keys(groupedFees).find((type) =>
        groupedFees[type].feeGroups.some((group) =>
          group.fields.some((field) => field.code === code)
        )
      );

      if (!feeType) {
        console.warn(`FeeType not found for exception code: ${code}`);
        continue;
      }

      let exceptionGroup = groupedFees[feeType]?.feeGroups.find(
        (group) => group.name === 'Exceptions'
      );
      if (!exceptionGroup) {
        exceptionGroup = {
          name: 'Exceptions',
          code: 3,
          fields: [],
        };
        groupedFees[feeType]?.feeGroups.push(exceptionGroup);
      }

      exceptionGroup.fields.push({
        code,
        name,
        defaultValue,
        tooltip,
        isException,
      });
    }

    console.log('Grouped Fees with Exceptions:', groupedFees);

    return { groupedFees: Object.values(groupedFees), accounts };
  }

  #getDocumentUrl(feePackageId) {
    return global.environment.scheduleUrls?.[feePackageId] || '';
  }

  #mapFeeType(feeType) {
    switch (feeType) {
      case 'Customer Fees':
        return 1;
      case 'Bank Account Fees':
        return 2;
      case 'Investment Account Fees':
        return 3;
      default:
        return 0;
    }
  }

  async #getFeesFromSQL(cifno) {
    const connection = await connectToFeeMgmtDb();
    return executeStoreProcedure(connection, 'sp_get_fees_byCIF', { cifno });
  }

  async #getExceptionFeesFromSQL(feePackageId) {
    const connection = await connectToFeeMgmtDb();
    const data = await executeStoreProcedure(
      connection,
      'sp_get_exception_fees_bypackage',
      { feePackageId }
    );

    return data.map((exception) => ({
      code: deParaFeeCodes[exception.FeeCode] || exception.FeeCode,
      name: exception.FeeDescription,
      defaultValue: exception.Amount?.toString() || '0',
      tooltip: exception.FreqDescription || '',
      isException: true,
    }));
  }
}
