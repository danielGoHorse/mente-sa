function mergeEquityOptionAll(excRows) {
  const equities = excRows.filter(r => r.FeeCode === "BPS004");
  const options  = excRows.filter(r => r.FeeCode === "BPS005");
  const allCodes = Array.from(
    new Set([...equities, ...options].map(r => r.Amount))
  );
  return allCodes
    .sort()
    .map(code => {
      const equity = equities.find(r => r.Amount === code);
      const option = options .find(r => r.Amount === code);

      // Validação: só monta se ambos Amount E FreqDescription existirem para equity OU option
      const equityValid = equity && equity.Amount && equity.FreqDescription;
      const optionValid = option && option.Amount && option.FreqDescription;
      if (!equityValid && !optionValid) return null;

      return {
        value: code,
        text:
          `${code} - ` +
          `Equity:${equityValid ? equity.FreqDescription.trim() : '-'}` +
          `; Option:${optionValid ? option.FreqDescription.trim() : '-'}`,
        visible: true,
        retired: false,
      };
    })
    .filter(Boolean); // Remove os nulos
}







