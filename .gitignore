import React, { useState, Fragment } from "react";
import Timeline from "../Timeline/timeline";
import TimelineApprovalsModal from "../TimelinePopover/timeLinePopover"; // ajuste para o path correto

// ...outros imports

export default function History({
  // ...props
  approvalsSteps = [],
  data,
  // outros props...
}) {
  const [hovered, setHovered] = useState(false);

  // Encontre o índice do círculo especial:
  const approvalsIdx = data.findIndex(
    (stepArr) =>
      stepArr.length === 1 &&
      stepArr[0].name === "Approvals and Restrictions"
  );

  return (
    <div className="p-6">
      <div className="text-[#484A55] font-figtree text-base font-semibold leading-[24px] tracking-[0.12px] text-left">
        Timeline
      </div>

      <Timeline.Root>
        {data.map((stepArr, idx) => {
          const step = stepArr[0];
          const isApprovals = step.name === "Approvals and Restrictions";
          return (
            <Timeline.Step key={step.id || idx} status={step.status}>
              <div
                onMouseEnter={() => isApprovals && setHovered(true)}
                onMouseLeave={() => isApprovals && setHovered(false)}
                className="relative flex flex-col items-center"
              >
                <Timeline.Circle status={step.status} />
                <Timeline.Text>{step.name}</Timeline.Text>
                {isApprovals && hovered && (
                  <TimelineApprovalsModal
                    open={true}
                    onClose={() => setHovered(false)}
                    data={approvalsSteps}
                  />
                )}
              </div>
            </Timeline.Step>
          );
        })}
      </Timeline.Root>
    </div>
  );
}
