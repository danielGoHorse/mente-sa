{
    "code": 200,
    "data": {
        "fees": [
            {
                "feeType": "Customer Fees",
                "feeGroups": [
                    {
                        "name": "Standard Fees",
                        "code": 1,
                        "fields": [
                            {
                                "code": 1,
                                "name": "Account Maintenance Fee",
                                "defaultValue": "50",
                                "tooltip": "Monthly - Charged Quarterly",
                                "isException": false,
                                "exceptionOptions": [],
                                "labelValue": "$50.00"
                            },
                            {
                                "code": 2,
                                "name": "Hold Mail Fee",
                                "defaultValue": "",
                                "tooltip": "Annual - Charged Annual",
                                "isException": false,
                                "exceptionOptions": [],
                                "labelValue": "$0.00"
                            }
                        ],
                        "kycMailingStatus": "Standard",
                        "cif": "MAA0475",
                        "accountNumber": 6244203
                    },
                    {
                        "name": "Client Current Fees",
                        "code": 2,
                        "fields": [
                            {
                                "code": 1,
                                "name": "Account Maintenance Fee",
                                "defaultValue": "",
                                "tooltip": "",
                                "isException": false,
                                "exceptionOptions": []
                            },
                            {
                                "code": 2,
                                "name": "Hold Mail Fee",
                                "defaultValue": "",
                                "tooltip": "",
                                "isException": false,
                                "exceptionOptions": []
                            }
                        ],
                        "cif": "MAA0475",
                        "accountNumber": 6244203
                    },
                    {
                        "name": "Exceptions Request",
                        "code": 3,
                        "fields": [
                            {
                                "code": 1,
                                "name": "Account Maintenance Fee",
                                "defaultValue": "0",
                                "tooltip": "",
                                "isException": true,
                                "exceptionOptions": [],
                                "labelValue": ""
                            }
                        ],
                        "cif": "MAA0475",
                        "accountNumber": 6244203
                    }
                ]
            },
            {
                "feeType": "Bank Account Fees",
                "feeGroups": [
                    {
                        "name": "Standard Fees",
                        "code": 1,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "25",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a9f750f6eff1b813659bf7"
                            },
                            {
                                "code": 8,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire (SafraLink) Fee",
                                "defaultValue": "10",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a9f750f6eff1b813659bf8"
                            }
                        ],
                        "cif": "MAA0475",
                        "accountNumber": "6244203",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a9f750f6eff1b813659bf6"
                    },
                    {
                        "name": "Client Current Fees",
                        "code": 2,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": false,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a9f750f6eff1b813659bfa"
                            }
                        ],
                        "cif": "MAA0475",
                        "accountNumber": "6244203",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a9f750f6eff1b813659bf9"
                    },
                    {
                        "name": "Exceptions Request",
                        "code": 3,
                        "fields": [
                            {
                                "code": 4,
                                "isStandard": false,
                                "isCurrentClient": false,
                                "isException": true,
                                "name": "FX Outgoing Wire Fee",
                                "defaultValue": "0",
                                "hasChanged": false,
                                "tooltip": "",
                                "exceptionOptions": [],
                                "_id": "67a9f750f6eff1b813659bfc",
                                "labelValue": ""
                            }
                        ],
                        "cif": "MAA0475",
                        "accountNumber": "6244203",
                        "visible": true,
                        "kycMailingStatus": null,
                        "_id": "67a9f750f6eff1b813659bfb"
                    }
                ]
            }
        ],
        "feesActives": []
    }
}






import Result from '#features/shared/result.js'

export default class FeeCaseGetByCifUseCase {
  async execute({ cif }, feeManagementModel, customerModel) {
    // global.logger.info(`customerModel.getCustomerDetailsByCif(${cif})`)
    const [errCustomer, responseCustomer] =
      await customerModel.getCustomerDetailsByCif(cif)

    if (errCustomer) {
      return Result.fail({ message: "It's not possible to get address cif" })
    }
    // global.logger.info('feeManagementModel.getFeeByAccount')
    const [errFee, responseFee] = await feeManagementModel.getFeeByAccount(
      responseCustomer.data.customer
    )

    if (errFee) {
      return Result.fail({ message: "Its's not possible get fee values" })
    }

    const currentFees =
      responseCustomer?.data?.customer?.customerCurrentFees?.map((x) => ({
        feeDescription: x.feeDescription,
        feeCode: x.feeCode
      }))

    const result = {
      customerName: responseCustomer.data.customer.customerAddress.name,
      customerAddress: responseCustomer.data.customer.customerAddress.address,
      customerAccountOfficer:
        responseCustomer.data.customer.customerAddress.officer,
      cif: responseCustomer.data.customer.customerAddress.cif,
      fees: responseFee.data.fees,
      feesActives: responseFee.data.feesActives,
      documentUrl: responseFee.data.documentUrl,
      currentFees
    }
    // global.logger.info('End process')
    console.log('RESULT >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>',result)
    return Result.ok(result)
  }
}
